<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>References · BioAlignments.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>BioAlignments.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="alignments.html">Alignment representation</a></li><li><a class="toctext" href="pairalign.html">Pairwise alignment</a></li><li><span class="toctext">IO</span><ul><li><a class="toctext" href="hts-files.html">SAM and BAM</a></li></ul></li><li class="current"><a class="toctext" href="references.html">References</a><ul class="internal"><li><a class="toctext" href="#Operations-1">Operations</a></li><li><a class="toctext" href="#Alignments-1">Alignments</a></li><li><a class="toctext" href="#Substitution-matrices-1">Substitution matrices</a></li><li><a class="toctext" href="#Pairwise-alignments-1">Pairwise alignments</a></li><li><a class="toctext" href="#I/O-1">I/O</a></li></ul></li><li><a class="toctext" href="contributing.html">Contributing</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="references.html">References</a></li></ul><a class="edit-page" href="https://github.com/BioJulia/BioAlignments.jl/blob/master/docs/src/references.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>References</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="References-1" href="#References-1">References</a></h1><h2><a class="nav-anchor" id="Operations-1" href="#Operations-1">Operations</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.Operation" href="#BioAlignments.Operation"><code>BioAlignments.Operation</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Alignment operation.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_MATCH" href="#BioAlignments.OP_MATCH"><code>BioAlignments.OP_MATCH</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;M&#39;</code>: non-specific match</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_INSERT" href="#BioAlignments.OP_INSERT"><code>BioAlignments.OP_INSERT</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;I&#39;</code>: insertion into reference sequence</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_DELETE" href="#BioAlignments.OP_DELETE"><code>BioAlignments.OP_DELETE</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;D&#39;</code>: deletion from reference sequence</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_SKIP" href="#BioAlignments.OP_SKIP"><code>BioAlignments.OP_SKIP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;N&#39;</code>: (typically long) deletion from the reference, e.g. due to RNA splicing</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_SOFT_CLIP" href="#BioAlignments.OP_SOFT_CLIP"><code>BioAlignments.OP_SOFT_CLIP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;S&#39;</code>: sequence removed from the beginning or end of the query sequence but stored</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_HARD_CLIP" href="#BioAlignments.OP_HARD_CLIP"><code>BioAlignments.OP_HARD_CLIP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;H&#39;</code>: sequence removed from the beginning or end of the query sequence and not stored</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_PAD" href="#BioAlignments.OP_PAD"><code>BioAlignments.OP_PAD</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;P&#39;</code>: not currently supported, but present for SAM/BAM compatibility</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_SEQ_MATCH" href="#BioAlignments.OP_SEQ_MATCH"><code>BioAlignments.OP_SEQ_MATCH</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;=&#39;</code>: match operation with matching sequence positions</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_SEQ_MISMATCH" href="#BioAlignments.OP_SEQ_MISMATCH"><code>BioAlignments.OP_SEQ_MISMATCH</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;X&#39;</code>: match operation with mismatching sequence positions</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_BACK" href="#BioAlignments.OP_BACK"><code>BioAlignments.OP_BACK</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;B&#39;</code>: not currently supported, but present for SAM/BAM compatibility</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OP_START" href="#BioAlignments.OP_START"><code>BioAlignments.OP_START</code></a> — <span class="docstring-category">Constant</span>.</div><div><p><code>&#39;0&#39;</code>: indicate the start of an alignment within the reference and query sequence</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.ismatchop" href="#BioAlignments.ismatchop"><code>BioAlignments.ismatchop</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">ismatchop(op::Operation)</code></pre><p>Test if <code>op</code> is a match operation (i.e. <code>op ∈ (OP_MATCH, OP_SEQ_MATCH, OP_SEQ_MISMATCH)</code>).</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L68-L72">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.isinsertop" href="#BioAlignments.isinsertop"><code>BioAlignments.isinsertop</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isinsertop(op::Operation)</code></pre><p>Test if <code>op</code> is a insertion operation (i.e. <code>op ∈ (OP_INSERT, OP_SOFT_CLIP, OP_HARD_CLIP)</code>).</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L77-L81">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.isdeleteop" href="#BioAlignments.isdeleteop"><code>BioAlignments.isdeleteop</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isdeleteop(op::Operation)</code></pre><p>Test if <code>op</code> is a deletion operation (i.e. <code>op ∈ (OP_DELETE, OP_SKIP)</code>).</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/operations.jl#L86-L90">source</a></section><h2><a class="nav-anchor" id="Alignments-1" href="#Alignments-1">Alignments</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.AlignmentAnchor" href="#BioAlignments.AlignmentAnchor"><code>BioAlignments.AlignmentAnchor</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Alignment operation with anchoring positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/anchors.jl#L9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.Alignment" href="#BioAlignments.Alignment"><code>BioAlignments.Alignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Alignment of two sequences.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.Alignment-Tuple{Array{BioAlignments.AlignmentAnchor,1},Bool}" href="#BioAlignments.Alignment-Tuple{Array{BioAlignments.AlignmentAnchor,1},Bool}"><code>BioAlignments.Alignment</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Alignment(anchors::Vector{AlignmentAnchor}, check=true)</code></pre><p>Create an alignment object from a sequence of alignment anchors.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L9-L13">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.Alignment-Tuple{AbstractString,Int64,Int64}" href="#BioAlignments.Alignment-Tuple{AbstractString,Int64,Int64}"><code>BioAlignments.Alignment</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Alignment(cigar::AbstractString, seqpos=1, refpos=1)</code></pre><p>Make an alignment object from a CIGAR string.</p><p><code>seqpos</code> and <code>refpos</code> specify the starting positions of two sequences.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L50-L56">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.seq2ref-Tuple{BioAlignments.Alignment,Integer}" href="#BioAlignments.seq2ref-Tuple{BioAlignments.Alignment,Integer}"><code>BioAlignments.seq2ref</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">seq2ref(aln::Alignment, i::Integer)::Tuple{Int,Operation}</code></pre><p>Map a position <code>i</code> from sequence to reference.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L103-L107">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.ref2seq-Tuple{BioAlignments.Alignment,Integer}" href="#BioAlignments.ref2seq-Tuple{BioAlignments.Alignment,Integer}"><code>BioAlignments.ref2seq</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">ref2seq(aln::Alignment, i::Integer)::Tuple{Int,Operation}</code></pre><p>Map a position <code>i</code> from reference to sequence.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L121-L125">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.cigar-Tuple{BioAlignments.Alignment}" href="#BioAlignments.cigar-Tuple{BioAlignments.Alignment}"><code>BioAlignments.cigar</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">cigar(aln::Alignment)</code></pre><p>Make a CIGAR string encoding of <code>aln</code>.</p><p>This is not entirely lossless as it discards the alignments start positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/alignment.jl#L139-L145">source</a></section><h2><a class="nav-anchor" id="Substitution-matrices-1" href="#Substitution-matrices-1">Substitution matrices</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.AbstractSubstitutionMatrix" href="#BioAlignments.AbstractSubstitutionMatrix"><code>BioAlignments.AbstractSubstitutionMatrix</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Supertype of substitution matrix.</p><p>The required method:</p><ul><li><p><code>Base.getindex(submat, x, y)</code>: substitution score/cost from <code>x</code> to <code>y</code></p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L9-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SubstitutionMatrix" href="#BioAlignments.SubstitutionMatrix"><code>BioAlignments.SubstitutionMatrix</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Substitution matrix.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L18-L20">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.DichotomousSubstitutionMatrix" href="#BioAlignments.DichotomousSubstitutionMatrix"><code>BioAlignments.DichotomousSubstitutionMatrix</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Dichotomous substitution matrix.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L148-L150">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.EDNAFULL" href="#BioAlignments.EDNAFULL"><code>BioAlignments.EDNAFULL</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>EDNAFULL (or NUC4.4) substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L219">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.PAM30" href="#BioAlignments.PAM30"><code>BioAlignments.PAM30</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>PAM30 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L222">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.PAM70" href="#BioAlignments.PAM70"><code>BioAlignments.PAM70</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>PAM70 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L225">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.PAM250" href="#BioAlignments.PAM250"><code>BioAlignments.PAM250</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>PAM250 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L228">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BLOSUM45" href="#BioAlignments.BLOSUM45"><code>BioAlignments.BLOSUM45</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>BLOSUM45 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L231">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BLOSUM50" href="#BioAlignments.BLOSUM50"><code>BioAlignments.BLOSUM50</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>BLOSUM50 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L234">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BLOSUM62" href="#BioAlignments.BLOSUM62"><code>BioAlignments.BLOSUM62</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>BLOSUM62 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L237">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BLOSUM80" href="#BioAlignments.BLOSUM80"><code>BioAlignments.BLOSUM80</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>BLOSUM80 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L240">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BLOSUM90" href="#BioAlignments.BLOSUM90"><code>BioAlignments.BLOSUM90</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>BLOSUM90 substitution matrix</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/submat.jl#L243">source</a></section><h2><a class="nav-anchor" id="Pairwise-alignments-1" href="#Pairwise-alignments-1">Pairwise alignments</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.PairwiseAlignment" href="#BioAlignments.PairwiseAlignment"><code>BioAlignments.PairwiseAlignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Pairwise alignment</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.count-Tuple{BioAlignments.PairwiseAlignment,BioAlignments.Operation}" href="#Base.count-Tuple{BioAlignments.PairwiseAlignment,BioAlignments.Operation}"><code>Base.count</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">count(aln::PairwiseAlignment, target::Operation)</code></pre><p>Count the number of positions where the <code>target</code> operation is applied.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L63-L67">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.count_matches" href="#BioAlignments.count_matches"><code>BioAlignments.count_matches</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">count_matches(aln)</code></pre><p>Count the number of matching positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L84-L88">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.count_mismatches" href="#BioAlignments.count_mismatches"><code>BioAlignments.count_mismatches</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">count_mismatches(aln)</code></pre><p>Count the number of mismatching positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L91-L95">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.count_insertions" href="#BioAlignments.count_insertions"><code>BioAlignments.count_insertions</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">count_insertions(aln)</code></pre><p>Count the number of inserting positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L98-L102">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.count_deletions" href="#BioAlignments.count_deletions"><code>BioAlignments.count_deletions</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">count_deletions(aln)</code></pre><p>Count the number of deleting positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L105-L109">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.count_aligned" href="#BioAlignments.count_aligned"><code>BioAlignments.count_aligned</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">count_aligned(aln)</code></pre><p>Count the number of aligned positions.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L112-L116">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.GlobalAlignment" href="#BioAlignments.GlobalAlignment"><code>BioAlignments.GlobalAlignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Global-global alignment with end gap penalties.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SemiGlobalAlignment" href="#BioAlignments.SemiGlobalAlignment"><code>BioAlignments.SemiGlobalAlignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Global-local alignment.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L18">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.OverlapAlignment" href="#BioAlignments.OverlapAlignment"><code>BioAlignments.OverlapAlignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Global-global alignment without end gap penalties.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L21">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.LocalAlignment" href="#BioAlignments.LocalAlignment"><code>BioAlignments.LocalAlignment</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Local-local alignment.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L24">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.EditDistance" href="#BioAlignments.EditDistance"><code>BioAlignments.EditDistance</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Edit distance.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L31">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.HammingDistance" href="#BioAlignments.HammingDistance"><code>BioAlignments.HammingDistance</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Hamming distance.</p><p>A special case of <code>EditDistance</code> with the costs of insertion and deletion are infinitely large.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L42-L47">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.LevenshteinDistance" href="#BioAlignments.LevenshteinDistance"><code>BioAlignments.LevenshteinDistance</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Levenshtein distance.</p><p>A special case of <code>EditDistance</code> with the costs of mismatch, insertion, and deletion are 1.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/types.jl#L34-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.AbstractScoreModel" href="#BioAlignments.AbstractScoreModel"><code>BioAlignments.AbstractScoreModel</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Supertype of score model.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/models.jl#L13-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.AffineGapScoreModel" href="#BioAlignments.AffineGapScoreModel"><code>BioAlignments.AffineGapScoreModel</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">AffineGapScoreModel(submat, gap_open, gap_extend)
AffineGapScoreModel(submat, gap_open=, gap_extend=)
AffineGapScoreModel(match=, mismatch=, gap_open=, gap_extend=)</code></pre><p>Affine gap scoring model.</p><p>This creates an affine gap scroing model object for alignment from a substitution matrix (<code>submat</code>), a gap opening score (<code>gap_open</code>), and a gap extending score (<code>gap_extend</code>). A consecutive gap of length <code>k</code> has a score of <code>gap_open + gap_extend * k</code>. Note that both of the gap scores should be non-positive.  As a shorthand of creating a dichotomous substitution matrix, you can write as, for example, <code>AffineGapScoreModel(match=5, mismatch=-3, gap_open=-2, gap_extend=-1)</code>.</p><p><strong>Example</strong></p><pre><code class="language-none">using BioSequences
using BioAlignments

# create an affine gap scoring model from a predefined substitution
# matrix and gap opening/extending scores.
affinegap = AffineGapScoreModel(BLOSUM62, gap_open=-10, gap_extend=-1)

# run global alignment between two amino acid sequenecs
pairalign(GlobalAlignment(), aa&quot;IDGAAGQQL&quot;, aa&quot;IDGATGQL&quot;, affinegap)</code></pre><p>See also: <code>SubstitutionMatrix</code>, <code>pairalign</code>, <code>CostModel</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/models.jl#L18-L47">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.AbstractCostModel" href="#BioAlignments.AbstractCostModel"><code>BioAlignments.AbstractCostModel</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Supertype of cost model.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/models.jl#L123-L125">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.CostModel" href="#BioAlignments.CostModel"><code>BioAlignments.CostModel</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">CostModel(submat, insertion, deletion)
CostModel(submat, insertion=, deletion=)
CostModel(match=, mismatch=, insertion=, deletion=)</code></pre><p>Cost model.</p><p>This creates a cost model object for alignment from substitution matrix (<code>submat</code>), an insertion cost (<code>insertion</code>), and a deletion cost (<code>deletion</code>). Note that both of the insertion and deletion costs should be non-negative.  As a shorthand of creating a dichotomous substitution matrix, you can write as, for example, <code>CostModel(match=0, mismatch=1, insertion=2, deletion=2)</code>.</p><p><strong>Example</strong></p><pre><code class="language-none">using BioAlignments

# create a cost model from a substitution matrix and indel costs
cost = CostModel(ones(128, 128) - eye(128), insertion=.5, deletion=.5)

# run global alignment to minimize edit distance
pairalign(EditDistance(), &quot;intension&quot;, &quot;execution&quot;, cost)</code></pre><p>See also: <code>SubstitutionMatrix</code>, <code>pairalign</code>, <code>AffineGapScoreModel</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/models.jl#L128-L153">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.PairwiseAlignmentResult" href="#BioAlignments.PairwiseAlignmentResult"><code>BioAlignments.PairwiseAlignmentResult</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Result of pairwise alignment</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/result.jl#L9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.pairalign" href="#BioAlignments.pairalign"><code>BioAlignments.pairalign</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">pairalign(type, seq, ref, model, [options...])</code></pre><p>Run pairwise alignment between two sequences: <code>seq</code> and <code>ref</code>.</p><p>Available <code>type</code>s are:</p><ul><li><p><code>GlobalAlignment()</code></p></li><li><p><code>LocalAlignment()</code></p></li><li><p><code>SemiGlobalAlignment()</code></p></li><li><p><code>OverlapAlignment()</code></p></li><li><p><code>EditDistance()</code></p></li><li><p><code>LevenshteinDistance()</code></p></li><li><p><code>HammingDistance()</code></p></li></ul><p><code>GlobalAlignment</code>, <code>LocalAlignment</code>, <code>SemiGlobalAlignment</code>, and <code>OverlapAlignment</code> are problem that maximizes alignment score between two sequences.  Therefore, <code>model</code> should be an instance of <code>AbstractScoreModel</code> (e.g. <code>AffineGapScoreModel</code>).</p><p><code>EditDistance</code>, <code>LevenshteinDistance</code>, and <code>HammingDistance</code> are problem that minimizes alignment cost between two sequences.  As for <code>EditDistance</code>, <code>model</code> should be an instance of <code>AbstractCostModel</code> (e.g. <code>CostModel</code>). <code>LevenshteinDistance</code> and <code>HammingDistance</code> have predefined a cost model, so users cannot specify a cost model for these alignment types.</p><p>When you pass the <code>score_only=true</code> or <code>distance_only=true</code> option to <code>pairalign</code>, the result of pairwise alignment holds alignment score/distance only.  This may enable some algorithms to run faster than calculating full alignment result.  Other available <code>options</code> are documented for each alignemnt type.</p><p><strong>Example</strong></p><pre><code class="language-none">using BioSequences
using BioAlignments

# create affine gap scoring model
affinegap = AffineGapScoreModel(
    match=5,
    mismatch=-4,
    gap_open=-5,
    gap_extend=-3
)

# run global alignment between two DNA sequences
pairalign(GlobalAlignment(), dna&quot;AGGTAG&quot;, dna&quot;ATTG&quot;, affinegap)

# run local alignment between two DNA sequences
pairalign(LocalAlignment(), dna&quot;AGGTAG&quot;, dna&quot;ATTG&quot;, affinegap)

# you cannot specify a cost model in LevenshteinDistance
pairalign(LevenshteinDistance(), dna&quot;AGGTAG&quot;, dna&quot;ATTG&quot;)</code></pre><p>See also: <code>AffineGapScoreModel</code>, <code>CostModel</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/pairalign.jl#L19-L75">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.score" href="#BioAlignments.score"><code>BioAlignments.score</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">score(alignment_result)</code></pre><p>Return score of alignment.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/result.jl#L33-L37">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioCore.distance" href="#BioCore.distance"><code>BioCore.distance</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">distance(alignment_result)</code></pre><p>Retrun distance of alignment.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/result.jl#L40-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.alignment" href="#BioAlignments.alignment"><code>BioAlignments.alignment</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">alignment(alignment_result)</code></pre><p>Return alignment if any.</p><p>See also: <code>hasalignment</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/result.jl#L55-L61">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.hasalignment" href="#BioAlignments.hasalignment"><code>BioAlignments.hasalignment</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">hasalignment(alignment_result)</code></pre><p>Check if alignment is stored or not.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/result.jl#L48-L52">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.seq2ref-Tuple{BioAlignments.PairwiseAlignment,Integer}" href="#BioAlignments.seq2ref-Tuple{BioAlignments.PairwiseAlignment,Integer}"><code>BioAlignments.seq2ref</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">seq2ref(aln::PairwiseAlignment, i::Integer)::Tuple{Int,Operation}</code></pre><p>Map a position <code>i</code> from the first sequence to the second.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L131-L135">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.ref2seq-Tuple{BioAlignments.PairwiseAlignment,Integer}" href="#BioAlignments.ref2seq-Tuple{BioAlignments.PairwiseAlignment,Integer}"><code>BioAlignments.ref2seq</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">ref2seq(aln::PairwiseAlignment, i::Integer)::Tuple{Int,Operation}</code></pre><p>Map a position <code>i</code> from the second sequence to the first.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/pairwise/alignment.jl#L140-L144">source</a></section><h2><a class="nav-anchor" id="I/O-1" href="#I/O-1">I/O</a></h2><h3><a class="nav-anchor" id="SAM-1" href="#SAM-1">SAM</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.Reader" href="#BioAlignments.SAM.Reader"><code>BioAlignments.SAM.Reader</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">SAM.Reader(input::IO)</code></pre><p>Create a data reader of the SAM file format.</p><p><strong>Arguments</strong></p><ul><li><p><code>input</code>: data source</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/reader.jl#L16-L23">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.header" href="#BioAlignments.SAM.header"><code>BioAlignments.SAM.header</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">header(reader::Reader)::Header</code></pre><p>Get the header of <code>reader</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/reader.jl#L32-L36">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.Header" href="#BioAlignments.SAM.Header"><code>BioAlignments.SAM.Header</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">SAM.Header()</code></pre><p>Create an empty header.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/header.jl#L8-L12">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.find-Tuple{BioAlignments.SAM.Header,AbstractString}" href="#Base.find-Tuple{BioAlignments.SAM.Header,AbstractString}"><code>Base.find</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">find(header::Header, key::AbstractString)::Vector{MetaInfo}</code></pre><p>Find metainfo objects satisfying <code>SAM.tag(metainfo) == key</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/header.jl#L41-L45">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.Writer" href="#BioAlignments.SAM.Writer"><code>BioAlignments.SAM.Writer</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Writer(output::IO, header::Header=Header())</code></pre><p>Create a data writer of the SAM file format.</p><p><strong>Arguments</strong></p><ul><li><p><code>output</code>: data sink</p></li><li><p><code>header=Header()</code>: SAM header object</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/writer.jl#L4-L12">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.MetaInfo" href="#BioAlignments.SAM.MetaInfo"><code>BioAlignments.SAM.MetaInfo</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">MetaInfo(str::AbstractString)</code></pre><p>Create a SAM metainfo from <code>str</code>.</p><p><strong>Examples</strong></p><pre><code class="language-none">julia&gt; SAM.MetaInfo(&quot;@CO	some comment&quot;)
BioAlignments.SAM.MetaInfo:
    tag: CO
  value: some comment

julia&gt; SAM.MetaInfo(&quot;@SQ	SN:chr1	LN:12345&quot;)
BioAlignments.SAM.MetaInfo:
    tag: SQ
  value: SN=chr1 LN=12345</code></pre></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L23-L40">source</a><div><pre><code class="language-none">MetaInfo(tag::AbstractString, value)</code></pre><p>Create a SAM metainfo with <code>tag</code> and <code>value</code>.</p><p><code>tag</code> is a two-byte ASCII string. If <code>tag</code> is <code>&quot;CO&quot;</code>, <code>value</code> must be a string; otherwise, <code>value</code> is an iterable object with key and value pairs.</p><p><strong>Examples</strong></p><pre><code class="language-none">julia&gt; SAM.MetaInfo(&quot;CO&quot;, &quot;some comment&quot;)
BioAlignments.SAM.MetaInfo:
    tag: CO
  value: some comment

julia&gt; string(ans)
&quot;@CO	some comment&quot;

julia&gt; SAM.MetaInfo(&quot;SQ&quot;, [&quot;SN&quot; =&gt; &quot;chr1&quot;, &quot;LN&quot; =&gt; 12345])
BioAlignments.SAM.MetaInfo:
    tag: SQ
  value: SN=chr1 LN=12345

julia&gt; string(ans)
&quot;@SQ	SN:chr1	LN:12345&quot;</code></pre></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L45-L71">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.iscomment" href="#BioAlignments.SAM.iscomment"><code>BioAlignments.SAM.iscomment</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">iscomment(metainfo::MetaInfo)::Bool</code></pre><p>Test if <code>metainfo</code> is a comment (i.e. its tag is &quot;CO&quot;).</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L154-L158">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.tag" href="#BioAlignments.SAM.tag"><code>BioAlignments.SAM.tag</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">tag(metainfo::MetaInfo)::String</code></pre><p>Get the tag of <code>metainfo</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L163-L167">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.value" href="#BioAlignments.SAM.value"><code>BioAlignments.SAM.value</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">value(metainfo::MetaInfo)::String</code></pre><p>Get the value of <code>metainfo</code> as a string.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L173-L177">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.keyvalues" href="#BioAlignments.SAM.keyvalues"><code>BioAlignments.SAM.keyvalues</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">keyvalues(metainfo::MetaInfo)::Vector{Pair{String,String}}</code></pre><p>Get the values of <code>metainfo</code> as string pairs.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/metainfo.jl#L183-L187">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.Record" href="#BioAlignments.SAM.Record"><code>BioAlignments.SAM.Record</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">SAM.Record()</code></pre><p>Create an unfilled SAM record.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L23-L27">source</a><div><pre><code class="language-none">SAM.Record(data::Vector{UInt8})</code></pre><p>Create a SAM record from <code>data</code>. This function verifies the format and indexes fields for accessors. Note that the ownership of <code>data</code> is transferred to a new record object.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L39-L45">source</a><div><pre><code class="language-none">SAM.Record(str::AbstractString)</code></pre><p>Create a SAM record from <code>str</code>. This function verifies the format and indexes fields for accessors.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L63-L68">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.flag" href="#BioAlignments.SAM.flag"><code>BioAlignments.SAM.flag</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">flag(record::Record)::UInt16</code></pre><p>Get the bitwise flag of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L133-L137">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.ismapped" href="#BioAlignments.SAM.ismapped"><code>BioAlignments.SAM.ismapped</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">ismapped(record::Record)::Bool</code></pre><p>Test if <code>record</code> is mapped.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L147-L151">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.isprimary" href="#BioAlignments.SAM.isprimary"><code>BioAlignments.SAM.isprimary</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isprimary(record::Record)::Bool</code></pre><p>Test if <code>record</code> is a primary line of the read.</p><p>This is equivalent to <code>flag(record) &amp; 0x900 == 0</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L156-L162">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.refname" href="#BioAlignments.SAM.refname"><code>BioAlignments.SAM.refname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">refname(record::Record)::String</code></pre><p>Get the reference sequence name of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L167-L171">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.position" href="#BioAlignments.SAM.position"><code>BioAlignments.SAM.position</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">position(record::Record)::Int</code></pre><p>Get the 1-based leftmost mapping position of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L184-L188">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.rightposition" href="#BioAlignments.SAM.rightposition"><code>BioAlignments.SAM.rightposition</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">rightposition(record::Record)::Int</code></pre><p>Get the 1-based rightmost mapping position of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L202-L206">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.isnextmapped" href="#BioAlignments.SAM.isnextmapped"><code>BioAlignments.SAM.isnextmapped</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isnextmapped(record::Record)::Bool</code></pre><p>Test if the mate/next read of <code>record</code> is mapped.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L215-L219">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.nextrefname" href="#BioAlignments.SAM.nextrefname"><code>BioAlignments.SAM.nextrefname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">nextrefname(record::Record)::String</code></pre><p>Get the reference name of the mate/next read of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L224-L228">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.nextposition" href="#BioAlignments.SAM.nextposition"><code>BioAlignments.SAM.nextposition</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">nextposition(record::Record)::Int</code></pre><p>Get the position of the mate/next read of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L241-L245">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.mappingquality" href="#BioAlignments.SAM.mappingquality"><code>BioAlignments.SAM.mappingquality</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">mappingquality(record::Record)::UInt8</code></pre><p>Get the mapping quality of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L259-L263">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.cigar" href="#BioAlignments.SAM.cigar"><code>BioAlignments.SAM.cigar</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">cigar(record::Record)::String</code></pre><p>Get the CIGAR string of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L277-L281">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.alignment" href="#BioAlignments.SAM.alignment"><code>BioAlignments.SAM.alignment</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">alignment(record::Record)::BioAlignments.Alignment</code></pre><p>Get the alignment of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L294-L298">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.alignlength" href="#BioAlignments.SAM.alignlength"><code>BioAlignments.SAM.alignlength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">alignlength(record::Record)::Int</code></pre><p>Get the alignment length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L311-L315">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.tempname" href="#BioAlignments.SAM.tempname"><code>BioAlignments.SAM.tempname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">tempname(record::Record)::String</code></pre><p>Get the query template name of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L337-L341">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.templength" href="#BioAlignments.SAM.templength"><code>BioAlignments.SAM.templength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">templength(record::Record)::Int</code></pre><p>Get the template length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L354-L358">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.sequence" href="#BioAlignments.SAM.sequence"><code>BioAlignments.SAM.sequence</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">sequence(record::Record)::BioSequences.DNASequence</code></pre><p>Get the segment sequence of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L372-L376">source</a><div><pre><code class="language-none">sequence(::Type{String}, record::Record)::String</code></pre><p>Get the segment sequence of <code>record</code> as <code>String</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L391-L395">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.seqlength" href="#BioAlignments.SAM.seqlength"><code>BioAlignments.SAM.seqlength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">seqlength(record::Record)::Int</code></pre><p>Get the sequence length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L401-L405">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.quality" href="#BioAlignments.SAM.quality"><code>BioAlignments.SAM.quality</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">quality(record::Record)::Vector{UInt8}</code></pre><p>Get the Phred-scaled base quality of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L418-L422">source</a><div><pre><code class="language-none">quality(::Type{String}, record::Record)::String</code></pre><p>Get the ASCII-encoded base quality of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L439-L443">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.auxdata" href="#BioAlignments.SAM.auxdata"><code>BioAlignments.SAM.auxdata</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">auxdata(record::Record)::Dict{String,Any}</code></pre><p>Get the auxiliary data (optional fields) of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/record.jl#L449-L453">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_PAIRED" href="#BioAlignments.SAM.FLAG_PAIRED"><code>BioAlignments.SAM.FLAG_PAIRED</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0001: the read is paired in sequencing, no matter whether it is mapped in a pair</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_PROPER_PAIR" href="#BioAlignments.SAM.FLAG_PROPER_PAIR"><code>BioAlignments.SAM.FLAG_PROPER_PAIR</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0002: the read is mapped in a proper pair</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_UNMAP" href="#BioAlignments.SAM.FLAG_UNMAP"><code>BioAlignments.SAM.FLAG_UNMAP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0004: the read itself is unmapped; conflictive with SAM.FLAG_PROPER_PAIR</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_MUNMAP" href="#BioAlignments.SAM.FLAG_MUNMAP"><code>BioAlignments.SAM.FLAG_MUNMAP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0008: the mate is unmapped</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_REVERSE" href="#BioAlignments.SAM.FLAG_REVERSE"><code>BioAlignments.SAM.FLAG_REVERSE</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0010: the read is mapped to the reverse strand</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_MREVERSE" href="#BioAlignments.SAM.FLAG_MREVERSE"><code>BioAlignments.SAM.FLAG_MREVERSE</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0020: the mate is mapped to the reverse strand</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_READ1" href="#BioAlignments.SAM.FLAG_READ1"><code>BioAlignments.SAM.FLAG_READ1</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0040: this is read1</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_READ2" href="#BioAlignments.SAM.FLAG_READ2"><code>BioAlignments.SAM.FLAG_READ2</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0080: this is read2</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_SECONDARY" href="#BioAlignments.SAM.FLAG_SECONDARY"><code>BioAlignments.SAM.FLAG_SECONDARY</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0100: not primary alignment</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_QCFAIL" href="#BioAlignments.SAM.FLAG_QCFAIL"><code>BioAlignments.SAM.FLAG_QCFAIL</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0200: QC failure</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_DUP" href="#BioAlignments.SAM.FLAG_DUP"><code>BioAlignments.SAM.FLAG_DUP</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0400: optical or PCR duplicate</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.SAM.FLAG_SUPPLEMENTARY" href="#BioAlignments.SAM.FLAG_SUPPLEMENTARY"><code>BioAlignments.SAM.FLAG_SUPPLEMENTARY</code></a> — <span class="docstring-category">Constant</span>.</div><div><p>0x0800: supplementary alignment</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/sam/flags.jl#L6">source</a></section><h3><a class="nav-anchor" id="BAM-1" href="#BAM-1">BAM</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.Reader" href="#BioAlignments.BAM.Reader"><code>BioAlignments.BAM.Reader</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">BAM.Reader(input::IO; index=nothing)</code></pre><p>Create a data reader of the BAM file format.</p><p><strong>Arguments</strong></p><ul><li><p><code>input</code>: data source</p></li><li><p><code>index=nothing</code>: filepath to a random access index (currently <em>bai</em> is supported)</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/reader.jl#L4-L12">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.header" href="#BioAlignments.BAM.header"><code>BioAlignments.BAM.header</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">header(reader::Reader; fillSQ::Bool=false)::SAM.Header</code></pre><p>Get the header of <code>reader</code>.</p><p>If <code>fillSQ</code> is <code>true</code>, this function fills missing &quot;SQ&quot; metainfo in the header.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/reader.jl#L48-L54">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.Writer" href="#BioAlignments.BAM.Writer"><code>BioAlignments.BAM.Writer</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">BAM.Writer(output::BGZFStream, header::SAM.Header)</code></pre><p>Create a data writer of the BAM file format.</p><p><strong>Arguments</strong></p><ul><li><p><code>output</code>: data sink</p></li><li><p><code>header</code>: SAM header object</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/writer.jl#L4-L12">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.Record" href="#BioAlignments.BAM.Record"><code>BioAlignments.BAM.Record</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">BAM.Record()</code></pre><p>Create an unfilled BAM record.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L4-L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.flag" href="#BioAlignments.BAM.flag"><code>BioAlignments.BAM.flag</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">flag(record::Record)::UInt16</code></pre><p>Get the bitwise flag of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L96-L100">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.ismapped" href="#BioAlignments.BAM.ismapped"><code>BioAlignments.BAM.ismapped</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">ismapped(record::Record)::Bool</code></pre><p>Test if <code>record</code> is mapped.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L110-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.isprimary" href="#BioAlignments.BAM.isprimary"><code>BioAlignments.BAM.isprimary</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isprimary(record::Record)::Bool</code></pre><p>Test if <code>record</code> is a primary line of the read.</p><p>This is equivalent to <code>flag(record) &amp; 0x900 == 0</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L119-L125">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.ispositivestrand" href="#BioAlignments.BAM.ispositivestrand"><code>BioAlignments.BAM.ispositivestrand</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">ispositivestrand(record::Record)::Bool</code></pre><p>Test if <code>record</code> is aligned to the positive strand.</p><p>This is equivalent to <code>flag(record) &amp; 0x10 == 0</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L130-L136">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.refid" href="#BioAlignments.BAM.refid"><code>BioAlignments.BAM.refid</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">refid(record::Record)::Int</code></pre><p>Get the reference sequence ID of <code>record</code>.</p><p>The ID is 1-based (i.e. the first sequence is 1) and is 0 for a record without a mapping position.</p><p>See also: <code>BAM.rname</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L141-L149">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.refname" href="#BioAlignments.BAM.refname"><code>BioAlignments.BAM.refname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">refname(record::Record)::String</code></pre><p>Get the reference sequence name of <code>record</code>.</p><p>See also: <code>BAM.refid</code></p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L169-L175">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.position" href="#BioAlignments.BAM.position"><code>BioAlignments.BAM.position</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">position(record::Record)::Int</code></pre><p>Get the 1-based leftmost mapping position of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L197-L201">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.rightposition" href="#BioAlignments.BAM.rightposition"><code>BioAlignments.BAM.rightposition</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">rightposition(record::Record)::Int</code></pre><p>Get the 1-based rightmost mapping position of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L211-L215">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.isnextmapped" href="#BioAlignments.BAM.isnextmapped"><code>BioAlignments.BAM.isnextmapped</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">isnextmapped(record::Record)::Bool</code></pre><p>Test if the mate/next read of <code>record</code> is mapped.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L225-L229">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.nextrefid" href="#BioAlignments.BAM.nextrefid"><code>BioAlignments.BAM.nextrefid</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">nextrefid(record::Record)::Int</code></pre><p>Get the next/mate reference sequence ID of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L234-L238">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.nextrefname" href="#BioAlignments.BAM.nextrefname"><code>BioAlignments.BAM.nextrefname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">nextrefname(record::Record)::String</code></pre><p>Get the reference name of the mate/next read of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L248-L252">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.nextposition" href="#BioAlignments.BAM.nextposition"><code>BioAlignments.BAM.nextposition</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">nextposition(record::Record)::Int</code></pre><p>Get the 1-based leftmost mapping position of the next/mate read of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L268-L272">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.mappingquality" href="#BioAlignments.BAM.mappingquality"><code>BioAlignments.BAM.mappingquality</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">mappingquality(record::Record)::UInt8</code></pre><p>Get the mapping quality of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L282-L286">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.cigar" href="#BioAlignments.BAM.cigar"><code>BioAlignments.BAM.cigar</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">cigar(record::Record)::String</code></pre><p>Get the CIGAR string of <code>record</code>.</p><p>Note that in the BAM specification, the field called <code>cigar</code> typically stores the cigar string of the record. However, this is not always true, sometimes the true cigar is very long, and due to  some constraints of the BAM format, the actual cigar string is stored in an extra tag: <code>CG:B,I</code>, and the <code>cigar</code> field stores a pseudo-cigar string.</p><p>Calling this method with <code>checkCG</code> set to <code>true</code> (default) this method will always yield the true cigar string, because this is probably what you want the vast majority of the time.</p><p>If you have a record that stores the true cigar in a <code>CG:B,I</code> tag, but you still want to access the pseudo-cigar that is stored in the <code>cigar</code> field of the BAM record, then you can set checkCG to <code>false</code>.</p><p>See also <code>BAM.cigar_rle</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L319-L340">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.cigar_rle" href="#BioAlignments.BAM.cigar_rle"><code>BioAlignments.BAM.cigar_rle</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">cigar_rle(record::Record, checkCG::Bool = true)::Tuple{Vector{BioAlignments.Operation},Vector{Int}}</code></pre><p>Get a run-length encoded tuple <code>(ops, lens)</code> of the CIGAR string in <code>record</code>.</p><p>Note that in the BAM specification, the field called <code>cigar</code> typically stores the cigar string of the record. However, this is not always true, sometimes the true cigar is very long, and due to  some constraints of the BAM format, the actual cigar string is stored in an extra tag: <code>CG:B,I</code>, and the <code>cigar</code> field stores a pseudo-cigar string.</p><p>Calling this method with <code>checkCG</code> set to <code>true</code> (default) this method will always yield the true cigar string, because this is probably what you want the vast majority of the time.</p><p>If you have a record that stores the true cigar in a <code>CG:B,I</code> tag, but you still want to access the pseudo-cigar that is stored in the <code>cigar</code> field of the BAM record, then you can set checkCG to <code>false</code>.</p><p>See also <code>BAM.cigar</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L349-L370">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.alignment" href="#BioAlignments.BAM.alignment"><code>BioAlignments.BAM.alignment</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">alignment(record::Record)::BioAlignments.Alignment</code></pre><p>Get the alignment of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L418-L422">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.alignlength" href="#BioAlignments.BAM.alignlength"><code>BioAlignments.BAM.alignlength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">alignlength(record::Record)::Int</code></pre><p>Get the alignment length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L451-L455">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.tempname" href="#BioAlignments.BAM.tempname"><code>BioAlignments.BAM.tempname</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">tempname(record::Record)::String</code></pre><p>Get the query template name of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L469-L473">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.templength" href="#BioAlignments.BAM.templength"><code>BioAlignments.BAM.templength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">templength(record::Record)::Int</code></pre><p>Get the template length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L484-L488">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.sequence" href="#BioAlignments.BAM.sequence"><code>BioAlignments.BAM.sequence</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">sequence(record::Record)::BioSequences.DNASequence</code></pre><p>Get the segment sequence of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L498-L502">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.seqlength" href="#BioAlignments.BAM.seqlength"><code>BioAlignments.BAM.seqlength</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">seqlength(record::Record)::Int</code></pre><p>Get the sequence length of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L520-L524">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.quality" href="#BioAlignments.BAM.quality"><code>BioAlignments.BAM.quality</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">quality(record::Record)::Vector{UInt8}</code></pre><p>Get the base quality of  <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L534-L538">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.auxdata" href="#BioAlignments.BAM.auxdata"><code>BioAlignments.BAM.auxdata</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">auxdata(record::Record)::BAM.AuxData</code></pre><p>Get the auxiliary data of <code>record</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/record.jl#L550-L554">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BioAlignments.BAM.BAI" href="#BioAlignments.BAM.BAI"><code>BioAlignments.BAM.BAI</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">BAI(filename::AbstractString)</code></pre><p>Load a BAI index from <code>filename</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/bai.jl#L18-L22">source</a><div><pre><code class="language-none">BAI(input::IO)</code></pre><p>Load a BAI index from <code>input</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/BioAlignments.jl/blob/e8fc758e824b8346df72a58adbecf24715e8299c/src/bam/bai.jl#L27-L31">source</a></section><footer><hr/><a class="previous" href="hts-files.html"><span class="direction">Previous</span><span class="title">SAM and BAM</span></a><a class="next" href="contributing.html"><span class="direction">Next</span><span class="title">Contributing</span></a></footer></article></body></html>
